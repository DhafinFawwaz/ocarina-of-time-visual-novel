# Characters
define link = Character("Link", color="#00ff00")
define navi = Character("Navi", color="#00ffff")
define deku = Character("Great Deku Tree", color="#8b4513")
define saria = Character("Saria", color="#90ee90")
define mido = Character("Mido", color="#556b2f")
define zelda = Character("Princess Zelda", color="#ff1493")
define impa = Character("Impa", color="#8b008b")
define darunia = Character("Darunia", color="#d2691e")
define ruto = Character("Princess Ruto", color="#4169e1")
define sheik = Character("Sheik", color="#4b0082")
define rauru = Character("Rauru", color="#ffd700")
define ganondorf = Character("Ganondorf", color="#8b0000")
define talon = Character("Talon", color="#daa520")
define malon = Character("Malon", color="#ff6347")
define kaepora = Character("Kaepora Gaebora", color="#cd853f")
define nabooru = Character("Nabooru", color="#ff4500")
define king_zora = Character("King Zora", color="#3f61ed")

# Images
image link child = Transform("link/child.png", xalign=0.5, yalign=0.5, zoom=0.5)
image link adult = Transform("link/adult.png", xalign=0.5, yalign=0.5, zoom=0.60)
image navi = Transform("navi/navi.webp", xalign=0.5, yalign=0.5, zoom=0.8)
image deku_tree = Transform("deku_tree/deku_tree.png", xalign=0.5, yalign=0.5, zoom=0.5)
image saria_sprite = Transform("saria/saria.png", xalign=0.5, yalign=0.5, zoom=0.275)
image mido_sprite = Transform("mido/mido.webp", xalign=0.5, yalign=0.5, zoom=0.8)
image zelda child = Transform("zelda/child.webp", xalign=0.5, yalign=0.5, zoom=0.2)
image zelda adult = Transform("zelda/adult.webp", xalign=0.5, yalign=0.5, zoom=0.2)
image impa_sprite = Transform("impa/impa.webp", xalign=0.5, yalign=0.5, zoom=0.3)
image darunia_sprite = Transform("darunia/darunia.webp", xalign=0.5, yalign=0.5, zoom=0.3)
image ruto_sprite = Transform("ruto/child.webp", xalign=0.5, yalign=0.5, zoom=0.25)
image sheik_sprite = Transform("sheik/sheik.webp", xalign=0.5, yalign=0.5, zoom=0.2)
image ganondorf_sprite = Transform("ganondorf/ganondorf.webp", xalign=0.5, yalign=0.5, zoom=0.2)
image gohma = Transform("gohma/gohma.webp", xalign=0.5, yalign=0.5, zoom=0.3)
image king_dodongo = Transform("king_dodongo/king_dodongo.webp", xalign=0.5, yalign=0.5, zoom=0.3)
image barinade = Transform("barinade/barinade.webp", xalign=0.5, yalign=0.5, zoom=0.3)
image phantom_ganon = Transform("phantom_ganon/phantom_ganon.webp", xalign=0.5, yalign=0.5, zoom=0.7)
image volvagia = Transform("volvagia/volvagia.webp", xalign=0.5, yalign=0.5, zoom=0.25)
image morpha = Transform("morpha/morpha.webp", xalign=0.5, yalign=0.5, zoom=2)
image bongo_bongo = Transform("bongo_bongo/bongo_bongo.webp", xalign=0.5, yalign=0.5, zoom=0.4)
image twinrova = Transform("twinrova/twinrova.webp", xalign=0.5, yalign=0.5, zoom=0.5)
image ganon = Transform("ganon/ganon.webp", xalign=0.5, yalign=0.5, zoom=0.4)
image kaepora = Transform("kaepora/kaepora.webp", xalign=0.5, yalign=0.5, zoom=0.4)
image nabooru = Transform("nabooru/nabooru.webp", xalign=0.5, yalign=0.5, zoom=0.2)
image king_zora = Transform("king_zora/king_zora.webp", xalign=0.5, yalign=0.5, zoom=0.35)
image malon = Transform("malon/malon.png", xalign=0.5, yalign=0.5, zoom=0.45)
image rauru = Transform("rauru/rauru.webp", xalign=0.5, yalign=0.5, zoom=0.2)
image talon = Transform("talon/talon.webp", xalign=0.5, yalign=0.5, zoom=0.4)

# Backgrounds
image bg kokiri_forest = Transform("backgrounds/kokiri_forest.jpg", fit="cover")
image bg kokiri_shop = Transform("backgrounds/kokiri_shop.webp", fit="cover")
image bg link_house = Transform("backgrounds/link_house.png", fit="cover")
image bg deku_tree_meadow = Transform("backgrounds/deku_tree_meadow.png", fit="cover")
image bg deku_tree_inside = Transform("backgrounds/deku_tree_inside.jpg", fit="cover")
image bg hyrule_field = Transform("backgrounds/hyrule_field.jpg", fit="cover")
image bg hyrule_castle = Transform("backgrounds/hyrule_castle.jpg", fit="cover")
image bg castle_courtyard = Transform("backgrounds/castle_courtyard.webp", fit="cover")
image bg throne_room = Transform("backgrounds/throne_room.jpg", fit="cover")
image bg kakariko_village = Transform("backgrounds/kakariko_village.jpg", fit="cover")
image bg death_mountain = Transform("backgrounds/death_mountain.webp", fit="cover")
image bg goron_city = Transform("backgrounds/goron_city.jpg", fit="cover")
image bg dodongo_cavern = Transform("backgrounds/dodongo_cavern.webp", fit="cover")
image bg zora_river = Transform("backgrounds/zora_river.webp", fit="cover")
image bg zora_domain = Transform("backgrounds/zoras_domain.jpg", fit="cover")
image bg jabu_jabu = Transform("backgrounds/jabu_jabu.png", fit="cover")
image bg lake_hylia = Transform("backgrounds/lake_hylia.webp", fit="cover")
image bg temple_of_time = Transform("backgrounds/temple_of_time.jpg", fit="cover")
image bg sacred_realm = Transform("backgrounds/sacred_realm.webp", fit="cover")
image bg lon_lon_ranch = Transform("backgrounds/lon_lon_ranch.webp", fit="cover")
image bg forest_temple = Transform("backgrounds/forest_temple.jpg", fit="cover")
image bg fire_temple = Transform("backgrounds/fire_temple.webp", fit="cover")
image bg water_temple = Transform("backgrounds/water_temple.webp", fit="cover")
image bg shadow_temple = Transform("backgrounds/shadow_temple.webp", fit="cover")
image bg spirit_temple = Transform("backgrounds/spirit_temple.png", fit="cover")
image bg ganon_castle = Transform("backgrounds/ganon_castle.png", fit="cover")
image bg final_battle = Transform("backgrounds/final_battle.jpg", fit="cover")
image bg black = "#000000"
image bg white = "#ffffff"

image item_popup_bg = Transform("items/frame.png", xalign=0.5, yalign=0.3, zoom=0.8)

# Item images
image item_kokiri_sword = Transform("items/kokiri_sword.png", zoom=3)
image item_deku_shield = Transform("items/deku_shield.png", zoom=3)
image item_fairy_ocarina = Transform("items/fairy_ocarina.png", zoom=1)
image item_kokiri_emerald = Transform("items/kokiri_emerald.png", zoom=0.7)
image item_goron_ruby = Transform("items/goron_ruby.png", zoom=0.8)
image item_zora_sapphire = Transform("items/zora_sapphire.png", zoom=0.75)
image item_ocarina_of_time = Transform("items/ocarina_of_time.png", zoom=0.95)
image item_master_sword = Transform("items/master_sword.png", zoom=1.8)
image item_heart_container = Transform("items/heart_container.webp", zoom=0.8)
image item_forest_medallion = Transform("items/forest_medallion.png", zoom=0.35)
image item_fire_medallion = Transform("items/fire_medallion.png", zoom=1.2)
image item_water_medallion = Transform("items/water_medallion.webp", zoom=1)
image item_shadow_medallion = Transform("items/shadow_medallion.png", zoom=0.35)
image item_spirit_medallion = Transform("items/spirit_medallion.webp", zoom=1)
image item_zelda_letter = Transform("items/zelda_letter.webp", zoom=1)
image item_slingshot = Transform("items/slingshot.webp", zoom=1)
image item_bombs = Transform("items/bombs.png", zoom=1)
image item_boomerang = Transform("items/boomerang.webp", zoom=1)
image item_hookshot = Transform("items/hookshot.webp", zoom=1)
image item_bow = Transform("items/bow.webp", zoom=1)
image item_megaton_hammer = Transform("items/megaton_hammer.webp", zoom=1.4)
image item_longshot = Transform("items/longshot.webp", zoom=1.1)
image item_hover_boots = Transform("items/hover_boots.webp", zoom=1.1)
image item_mirror_shield = Transform("items/mirror_shield.webp", zoom=1.2)
image item_light_arrows = Transform("items/light_arrows.webp", zoom=1)

label item_get(item_name, item_image):
    play sound "sound/item_get.mp3"
    show item_popup_bg with dissolve
    show expression Transform(item_image, xalign=0.5, yalign=0.28, zoom=0.6) as item_display with dissolve
    show expression VBox(
        Text("You got the [item_name]", size=30, xalign=0.5),
        Text("Click to continue", size=24, xalign=0.5),
        spacing=20
    ) as item_desc at itemcenter with dissolve
    pause
    hide item_display
    hide item_popup_bg
    hide item_desc
    return

# Variables
default has_sword = False
default has_shield = False
default has_kokiri_emerald = False
default has_goron_ruby = False
default has_zora_sapphire = False
default has_ocarina = False
default has_master_sword = False
default is_adult = False
default deku_tree_complete = False
default dodongo_cavern_complete = False
default jabu_jabu_complete = False
default met_zelda = False
default learned_zelda_lullaby = False
default learned_saria_song = False
default can_enter_death_mountain = False
default can_enter_zora_domain = False
default has_slingshot = False
default has_bomb_bag = False
default has_boomerang = False
default has_hookshot = False
default has_bow = False
default has_megaton_hammer = False
default has_fairy_bow = False
default has_ocarina_of_time = False
default has_longshot = False
default has_hover_boots = False
default has_mirror_shield = False

default has_fire_medallion = False
default has_water_medallion = False
default has_shadow_medallion = False
default has_spirit_medallion = False
default has_forest_medallion = False

# Boss health
default gohma_health = 3
default dodongo_health = 3
default barinade_health = 3
default phantom_ganon_health = 3
default volvagia_health = 3
default morpha_health = 3
default bongo_health = 3
default twinrova_health = 3
default ganon_health = 5
default phantom_ganon_battle_ganon_health = 5

# Transforms
transform midleft:
    yalign 0.65
    xcenter 0.2
transform midright:
    yalign 0.65
    xcenter 0.8
transform midcenter:
    yalign 0.65
    xcenter 0.5
transform itemcenter:
    yalign 0.505
    xcenter 0.5

transform navileft:
    yalign 0.4
    xcenter 0.2
transform naviright:
    yalign 0.4
    xcenter 0.8

# Transform Effects
transform shake:
    linear 0.05 xoffset -5 yoffset -5
    linear 0.05 xoffset 5 yoffset 5
    linear 0.05 xoffset -5 yoffset 5
    linear 0.05 xoffset 5 yoffset -5
    linear 0.05 xoffset 0 yoffset 0
    repeat 3

label start:
    scene bg black
    
    show expression VBox(
        Text("The Legend of Zelda: Ocarina of Time", size=60, xalign=0.5),
        Text("Visual Novel Edition", size=36, xalign=0.5),
        spacing=20
    ) at truecenter with dissolve
    pause 3.0
    hide text with dissolve
    pause 1.0
    
    stop music fadeout 2.0
    
    scene bg black
    with fade
    
    play music "audio/kokiri_forest_theme.mp3" if_changed
    
    "Long ago, in the mystical land of Hyrule..."
    "A young boy lived in Kokiri Forest, a place where children never grow up."
    "But this boy was different. He had no fairy companion."
    "Until one fateful day..."
    
    scene bg link_house
    with fade
    
    show navi
    play sound "sound/navi_hello.mp3"
    
    navi "Link! Wake up! Link!"
    
    show link child at midleft
    with dissolve
    
    link "Huh? A fairy? You're... you're my fairy?"
    
    navi "Yes! I'm Navi! The Great Deku Tree has summoned you. We must go to him at once!"
    
    link "The Great Deku Tree? But I've never been allowed to see him before..."
    
    navi "Things have changed, Link. There's darkness spreading in the forest. The Great Deku Tree needs your help!"
    
    menu:
        navi "Will you come with me to see the Great Deku Tree?"
        
        "Yes, let's go right away!":
            link "Of course! If the Great Deku Tree needs me, I'll go immediately!"
            navi "That's the spirit! But first, you should prepare yourself. You'll need equipment."
            
        "What kind of darkness?":
            link "What do you mean by darkness? What's happening?"
            navi "I don't know all the details, but the Great Deku Tree is in danger. He'll explain everything when we see him."
            navi "But you'll need to be prepared. Make sure you have a sword and shield first!"
    
    scene bg kokiri_forest
    with fade
    
    show link child
    with dissolve
    
    link "Kokiri Forest... my home. But I always felt like I didn't quite belong here."
    
    show navi at naviright
    
    navi "Link, before we can see the Great Deku Tree, you need to get a sword and shield. Every adventurer needs proper equipment!"
    
    jump kokiri_forest_hub

label kokiri_forest_hub:
    scene bg kokiri_forest
    show link child
    show navi at naviright
    
    menu:
        navi "Where do you want to go, Link?"
        
        "Go to the Great Deku Tree":
            if has_sword and has_shield:
                navi "You have your sword and shield! Let's go see the Great Deku Tree!"
                jump approach_deku_tree
            else:
                jump blocked_by_mido
                
        "Look for a sword":
            if has_sword:
                navi "You already have the Kokiri Sword!"
                jump kokiri_forest_hub
            else:
                jump get_sword
                
        "Look for a shield":
            if has_shield:
                navi "You already have the Deku Shield!"
                jump kokiri_forest_hub
            else:
                jump get_shield
                
        "Visit Saria":
            if learned_saria_song:
                navi "We already visited Saria. Should we go somewhere else?"
                jump kokiri_forest_hub
            else:
                jump visit_saria

label blocked_by_mido:
    scene bg kokiri_forest
    show link child at midleft
    
    show mido_sprite at midright
    with dissolve
    
    play sound "audio/door_locked.mp3"
    
    mido "Hey! Where do you think you're going, Mr. No, Fairy?"
    
    if not has_sword or not has_shield:
        mido "You can't go see the Great Deku Tree without proper equipment! Come back when you have a sword and shield!"
    
    link "But Mido..."
    
    mido "No buts! Those are the rules. Even if the Great Deku Tree summoned you, you need to be prepared!"
    
    hide mido_sprite
    
    navi "We need to find a sword and shield, Link. Let's go look for them."
    
    jump kokiri_forest_hub

label get_sword:
    scene bg kokiri_forest
    show link child
    show navi at naviright
    
    navi "I heard there's a training area in the forest where you can get a sword. Let's check it out!"
    
    scene bg black
    with fade
    
    "Link ventures through a small maze in the forest..."
    
    scene bg kokiri_forest
    with fade
    
    show link child
    
    link "There it is! The Kokiri Sword!"
    
    call item_get("Kokiri Sword", "item_kokiri_sword")
    
    $ has_sword = True
    
    show navi at naviright
    
    navi "Great! Now you have a sword! If you need a shield, we should find one before going to the Deku Tree."
    
    jump kokiri_forest_hub

label get_shield:
    scene bg kokiri_forest
    show link child
    show navi at naviright
    
    navi "You can buy a Deku Shield from the shop in the village. Let's go!"
    
    scene bg kokiri_shop
    with fade
    
    "Link visits the Kokiri Shop..."
    
    play sound "audio/shop_bell.mp3"
    
    "Shopkeeper" "Welcome! A Deku Shield costs 40 rupees!"
    
    "Link checks his wallet and has just enough..."
    
    play sound "audio/rupee.mp3"
    
    "Link bought the Deku Shield!"
    
    call item_get("Deku Shield", "item_deku_shield")
    
    $ has_shield = True
    
    scene bg kokiri_forest
    with fade
    
    show link child
    show navi at naviright
    
    navi "Perfect! Now you have both a sword and shield. Let's go see the Great Deku Tree!"
    
    jump kokiri_forest_hub

label visit_saria:
    scene bg kokiri_forest
    with fade
    
    show link child at midleft
    
    "Link walks deeper into the forest to the Sacred Forest Meadow..."
    
    show saria_sprite at midright
    with dissolve
    
    play music "audio/saria_song.mp3" if_changed
    
    saria "Link! I'm so glad you came to see me!"
    
    link "Saria, the Great Deku Tree summoned me. Something's wrong in the forest."
    
    saria "I know... I can feel it too. The forest is crying out in pain."
    
    saria "Link, I want you to have this. It's my ocarina."
    
    call item_get("Fairy Ocarina", "item_fairy_ocarina")
    
    $ has_ocarina = True
    $ learned_saria_song = True
    
    saria "Whenever you play this song, think of me. No matter where you are, we'll always be friends."
    
    link "Thank you, Saria. I'll treasure it always."
    
    saria "Be careful, Link. I have a feeling your destiny lies beyond this forest."
    
    jump kokiri_forest_hub

label approach_deku_tree:
    scene bg kokiri_forest
    with fade
    
    show link child
    show navi at naviright
    
    navi "This is it, Link! The path to the Great Deku Tree!"
    
    scene bg black
    with fade
    
    "Link and Navi approach the Great Deku Tree..."
    
    scene bg deku_tree_meadow
    with fade
    
    show deku_tree
    with dissolve
    
    play music "audio/deku_tree_theme.mp3" if_changed
    
    deku "Link... Thank you for coming, my boy."
    
    show link child at midleft
    show navi at naviright
    
    link "Great Deku Tree! What's wrong? Navi said you were in danger!"
    
    deku "A curse has been placed upon me by an evil man from the desert. The darkness is spreading inside me, consuming my life force."
    
    navi "No! Who would do such a thing?"
    
    deku "His name is Ganondorf. He seeks the Triforce, the sacred treasure hidden in the Sacred Realm."
    
    deku "Link, you are the only one who can help me. You must break the curse from within!"
    
    menu:
        deku "Will you enter my body and destroy the evil inside?"
        
        "I'll do it! I'll save you!":
            link "Of course! I won't let you down, Great Deku Tree!"
            deku "Your courage knows no bounds, young one. I knew I was right to call upon you."
            
        "What will I face inside?":
            link "What kind of evil is inside you? What should I prepare for?"
            deku "An ancient parasite, spawned from the curse. It has taken root deep within me. You must destroy it to break the curse."
    
    deku "Enter through my mouth, Link. May the goddess protect you..."
    
    scene bg black
    with fade
    
    jump inside_deku_tree

label inside_deku_tree:
    scene bg deku_tree_inside
    with fade
    
    play music "audio/inside_deku_tree.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "It's dark in here, Link. Stay alert!"
    
    link "I can feel the evil presence. It's coming from deep below."
    
    "Link navigates through the Great Deku Tree..."
    
    scene bg black
    with fade
    
    "Link finds a treasure chest!"
    
    scene bg deku_tree_inside
    with fade
    
    show link child
    
    link "What's this?"
    
    call item_get("Fairy Slingshot", "item_slingshot")
    $ has_slingshot = True
    
    show navi at naviright
    
    navi "The Fairy Slingshot! You can use Deku Seeds as ammunition to hit distant targets!"
    
    link "This will be useful!"
    
    "Link continues through the dungeon, solving puzzles and fighting monsters..."
    
    scene bg black
    with fade
    
    "After fighting through various enemies and solving puzzles..."
    
    scene bg deku_tree_inside
    with fade
    
    show link child
    show navi at naviright
    
    navi "Look! There's a large chamber ahead. I think the boss is in there!"
    
    link "I'm ready. Let's go!"
    
    jump boss_gohma

label boss_gohma:
    scene bg black
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    scene bg deku_tree_inside
    with fade
    
    show gohma
    with dissolve
    
    "A massive spider-like creature descends from the ceiling!"
    
    show link child at midleft
    show navi at naviright
    
    navi "That's Queen Gohma! Be careful, Link!"
    
    $ gohma_health = 3
    
    jump gohma_battle

label gohma_battle:
    if gohma_health <= 0:
        jump gohma_defeated
    
    show gohma
    
    navi "Her eye is her weak point! But you need to stun her first!"
    
    menu:
        "Use sword":
            link "Take this!"
            play sound "sound/sword_slash.wav"
            "Link slashes at Gohma, but his sword bounces off her hard carapace!"
            navi "That didn't work! Try something else!"
            jump gohma_battle
            
        "Use slingshot":
            link "Let's try the slingshot!"
            play sound "sound/slingshot.wav"
            show gohma at shake
            "Link shoots a seed directly into Gohma's eye!"
            play sound "audio/enemy_hit.mp3"
            "Gohma reels back in pain and falls to the ground, stunned!"
            
            menu:
                navi "Now! Attack while she's down!"
                
                "Strike with sword":
                    link "Now's my chance!"
                    play sound "sound/sword_slash.wav"
                    show gohma at shake
                    "Link rushes forward and slashes at Gohma's vulnerable eye!"
                    $ gohma_health -= 1
                    play sound "sound/enemy_hit.wav"
                    
                    if gohma_health > 0:
                        play sound "audio/enemy_hurt.mp3"
                        "Gohma screeches in pain and climbs back up to the ceiling!"
                        navi "Good job! Do that [gohma_health] more times!"
                        jump gohma_battle
                    else:
                        jump gohma_defeated
                        
                "Wait":
                    "Link hesitates and Gohma recovers, climbing back up!"
                    navi "You missed your chance! Try again!"
                    jump gohma_battle

label gohma_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Queen Gohma lets out a final screech and disintegrates into dark particles!"
    
    hide gohma
    
    show navi at naviright
    
    navi "We did it, Link! The curse is broken!"
    
    call item_get("Heart Container", "item_heart_container")
    
    "A blue light surrounds Link and Navi..."
    
    scene bg black
    with fade
    
    "Link is transported outside..."
    
    scene bg deku_tree_meadow
    with fade
    
    play music "audio/deku_tree_theme.mp3" if_changed
    
    show deku_tree
    show link child at midleft
    show navi at naviright
    
    deku "Link... you have done well, my boy."
    
    link "Great Deku Tree! You're saved now, right?"
    
    deku "I'm afraid not, Link. The curse was broken, but it came too late. I am dying."
    
    navi "No! That can't be!"
    
    deku "Do not mourn for me. This is the way of all things. But before I pass, I must tell you of your destiny."
    
    deku "Link, you are not a Kokiri. You are a Hylian, left in this forest as a baby during a great war."
    
    link "What? I'm... not a Kokiri?"
    
    deku "Your mother entrusted you to me with her dying breath. I raised you as one of the Kokiri children."
    
    deku "But now, your true destiny calls. You must go to Hyrule Castle and speak with Princess Zelda."
    
    call item_get("Kokiri Emerald", "item_kokiri_emerald")
    $ has_kokiri_emerald = True
    
    deku "This is the Spiritual Stone of the Forest. Guard it well... It is one of three keys to the Sacred Realm."
    
    link "Great Deku Tree..."
    
    deku "Go now, Link. Save Hyrule from the darkness that threatens it. This is your destiny..."
    
    "The Great Deku Tree's eyes close slowly..."
    
    hide deku_tree
    with dissolve
    
    "The Great Deku Tree has passed away..."
    
    link "..."
    
    navi "Link... we have to go. The Great Deku Tree wanted you to save Hyrule. We can't let him down."
    
    menu:
        navi "Are you ready to leave the forest?"
        
        "Yes, let's go to Hyrule Castle":
            link "You're right, Navi. I'll honor his wish. Let's go find Princess Zelda."
            jump leave_kokiri_forest
            
        "I need a moment...":
            link "Just... give me a moment to say goodbye."
            navi "Of course, Link. Take your time."
            "Link looks around the forest one last time..."
            jump leave_kokiri_forest

label leave_kokiri_forest:
    scene bg kokiri_forest
    with fade
    
    show saria_sprite at midright
    with dissolve
    
    play music "audio/saria_song.mp3" if_changed
    
    saria "Link! Wait!"
    
    show link child at midleft
    
    link "Saria..."
    
    saria "I heard about the Great Deku Tree. I'm so sorry, Link."
    
    saria "But I also heard you're leaving the forest. Is it true?"
    
    link "Yes. I have to go to Hyrule Castle. It's my destiny."
    
    saria "I knew this day would come. You were always different from the rest of us."
    
    saria "Link, no matter where you go or what happens, remember that you'll always be my friend."
    
    link "Thank you, Saria. I'll never forget you."
    
    saria "Promise me you'll come back and visit someday?"
    
    link "I promise."
    
    hide saria_sprite
    with dissolve
    
    show navi at naviright
    
    navi "It's time to go, Link. Hyrule Castle awaits!"
    
    scene bg black
    with fade
    
    jump hyrule_field_first_time

label hyrule_field_first_time:
    scene bg hyrule_field
    with fade
    
    play music "audio/hyrule_field_theme.mp3" if_changed
    
    show link child at midleft
    show navi at naviright
    
    link "Wow... it's so big! I've never seen anything like this!"
    
    navi "This is Hyrule Field, Link! And look, there's Hyrule Castle Town in the distance!"
    
    show kaepora at midcenter
    with dissolve
    
    play sound "audio/owl_hoot.mp3"
    
    kaepora "Hoot hoot! Hello there, young one!"
    
    link "An owl?"
    
    kaepora "I am Kaepora Gaebora. I have been watching you, Link. You carry the Kokiri's Emerald, I see."
    
    navi "How do you know Link's name?"
    
    kaepora "I know many things, little fairy. Link, you seek Princess Zelda, do you not?"
    
    link "Yes! Do you know where I can find her?"
    
    kaepora "She resides in Hyrule Castle. But be warned, a man with evil intentions also seeks an audience with the King."
    
    kaepora "His name is Ganondorf, the Gerudo King. Do not trust him!"
    
    navi "Ganondorf! That's the man who cursed the Great Deku Tree!"
    
    kaepora "Indeed. Now go, Link! Make haste to the castle! Hoot hoot!"
    
    hide kaepora
    with dissolve
    
    navi "Let's go to Hyrule Castle, Link!"
    
    scene bg black
    with fade
    
    jump hyrule_castle_approach

label hyrule_castle_approach:
    scene bg hyrule_castle
    with fade
    
    play music "audio/castle_theme.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "There it is! Hyrule Castle!"
    
    link "It's magnificent... but how do we get in to see the princess?"
    
    "Link sneaks past the guards in the castle courtyard..."
    
    scene bg castle_courtyard
    with fade
    
    show link child
    
    "Link peers through a window..."
    
    show zelda child at midright
    with dissolve
    
    play music "audio/zelda_theme.mp3" if_changed
    
    zelda "Link! You're finally here!"
    
    link "Princess Zelda? But how do you know my name?"
    
    zelda "I've been having dreams about you. Dreams of a dark future where Hyrule is consumed by evil."
    
    show link child at midleft
    with dissolve

    show impa_sprite at midcenter
    with dissolve
    
    impa "Your Highness, is this the boy from your dreams?"
    
    zelda "Yes, Impa. This is Link, the Hero of Time."
    
    link "Hero of Time? I don't understand..."
    
    zelda "Link, I'll explain. A man named Ganondorf has sworn loyalty to my father, but I don't trust him."
    
    zelda "He seeks the Triforce. A sacred treasure that grants the wishes of whoever touches it."
    
    zelda "In my dreams, I saw Ganondorf standing over Hyrule, covered in darkness. And I saw you standing against him."
    
    # show ganondorf_sprite at midleft
    # with dissolve
    
    play music "audio/ganondorf_theme.mp3" if_changed
    
    "A tall, imposing figure rides past on horseback..."
    
    # ganondorf "..."
    
    "His evil gaze pierces through the window..."
    
    # hide ganondorf_sprite
    
    zelda "Did you see him? That look in his eyes... There's nothing but evil there!"
    
    zelda "Link, you have the Kokiri's Emerald, right?"
    
    link "Yes, the Great Deku Tree entrusted it to me before he died."
    
    zelda "I'm so sorry... But we need all three Spiritual Stones to open the Door of Time and reach the Sacred Realm before Ganondorf does!"
    
    zelda "I have a plan. We'll gather the three Spiritual Stones and open the Door of Time first. Then we'll keep the Triforce safe from Ganondorf!"
    
    navi "What are the other two Spiritual Stones?"
    
    zelda "The Goron's Ruby, protected by the Gorons on Death Mountain, and the Zora's Sapphire, guarded by the Zoras in their Domain."
    
    impa "Link, I will teach you the Zelda's Lullaby. This song will help you on your journey."
    
    play sound "audio/ocarina.mp3"
    
    "Impa teaches Link Zelda's Lullaby..."
    
    $ learned_zelda_lullaby = True
    
    zelda "Take this letter. It bears the royal seal. It will grant you passage wherever you need to go."
    
    call item_get("Zelda's Letter", "item_zelda_letter")
    
    $ met_zelda = True
    
    link "I won't let you down, Princess. I'll get the other two Spiritual Stones!"
    
    zelda "I know you will, Link. May the goddesses watch over you."
    
    scene bg black
    with fade
    
    $ can_enter_death_mountain = True
    $ can_enter_zora_domain = True
    
    jump hyrule_field_hub

label hyrule_field_hub:
    scene bg hyrule_field
    with fade
    
    play music "audio/hyrule_field_theme.mp3" if_changed
    
    show link child at midleft
    show navi at naviright
    
    menu:
        navi "So Link, where do you want to go?"
        
        "Go to Death Mountain":
            if can_enter_death_mountain and not has_goron_ruby:
                navi "Death Mountain! Home of the Gorons! Let's get the Goron's Ruby!"
                jump death_mountain_approach
            elif has_goron_ruby:
                navi "We already got the Goron's Ruby from there! Let's go somewhere else."
                jump hyrule_field_hub
            else:
                navi "We need Zelda's letter to get past the guard at Death Mountain!"
                jump hyrule_field_hub
                
        "Go to Zora's Domain":
            if can_enter_zora_domain and not has_zora_sapphire:
                navi "Zora's Domain! Let's find the Zora's Sapphire!"
                jump zora_domain_approach
            elif has_zora_sapphire:
                navi "We already got the Zora's Sapphire! Let's go somewhere else."
                jump hyrule_field_hub
            else:
                navi "We need to find a way to Zora's Domain!"
                jump hyrule_field_hub
                
        "Visit Lon Lon Ranch":
            navi "Lon Lon Ranch! Maybe we can rest there for a bit."
            jump lon_lon_ranch
            
        "Return to Hyrule Castle" if has_kokiri_emerald and has_goron_ruby and has_zora_sapphire:
            navi "We have all three Spiritual Stones! Let's return to see Princess Zelda!"
            jump return_to_castle

label lon_lon_ranch:
    scene bg lon_lon_ranch
    with fade
    
    play music "audio/lon_lon_ranch_theme.mp3" if_changed
    
    show link child
    
    "Link enters the peaceful ranch..."
    
    show malon at midright
    with dissolve
    
    malon "Oh! A visitor! Hi there! I'm Malon!"
    
    link "Hi, I'm Link. This is a nice place you have here."
    
    malon "Thanks! My dad Talon and I run this ranch. We raise the best horses in all of Hyrule!"
    
    malon "Hey, do you want to hear a song? My mother taught it to me."
    
    play sound "audio/epona_song.mp3"
    
    "Malon sings Epona's Song..."
    
    malon "Isn't it pretty? The horses love it!"
    
    link "It's beautiful. Thank you for sharing it with me."
    
    malon "If you ever need anything, come visit us again, okay?"
    
    hide malon
    
    show navi at naviright
    
    navi "She's nice! But we should get back to our quest, Link."
    
    jump hyrule_field_hub

label death_mountain_approach:
    scene bg black
    with fade
    
    "Link travels to Kakariko Village at the foot of Death Mountain..."
    
    scene bg kakariko_village
    with fade
    
    play music "audio/kakariko_theme.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "This is Kakariko Village! Death Mountain is just beyond here."
    
    "Link shows Zelda's letter to the guard..."
    
    "Guard" "A letter from Princess Zelda? You may pass! Be careful on the mountain, young one!"
    
    scene bg death_mountain
    with fade
    
    play music "audio/death_mountain_theme.mp3" if_changed
    
    show link child
    
    link "It's so hot here... and there are falling boulders!"
    
    show navi at naviright
    
    navi "Be careful, Link! Let's find the Gorons!"
    
    "Link climbs the treacherous mountain path..."
    
    scene bg goron_city
    with fade
    
    show link child
    
    "Link enters the Goron City carved inside the mountain..."
    
    navi "Look! Gorons! But they all look sad..."
    
    "Goron" "Our Big Brother Darunia has shut himself in his room. He won't come out or talk to anyone..."
    
    navi "We need to cheer up their leader! Maybe music will help?"
    
    link "Let me try playing Saria's Song!"
    
    play sound "audio/saria_song.mp3"
    
    "Link plays Saria's Song on his ocarina..."
    
    show darunia_sprite at midright
    with dissolve

    show link child at midleft
    with dissolve
    
    play sound "audio/door_open.mp3"
    
    darunia "What the! That song! It reminds me of my old friend from the forest!"
    
    "Darunia begins dancing joyfully!"
    
    darunia "Ha ha ha! I feel great! That was Saria's song, wasn't it? You know Saria?"
    
    link "Yes! She's my best friend!"
    
    darunia "Anyone who's a friend of Saria is a Brother to me! I'm Darunia, leader of the Gorons!"
    
    darunia "But I must apologize, Brother. Even though that song cheered me up, I still have big problems."
    
    link "What's wrong?"
    
    darunia "An evil dragon has awakened in Dodongo's Cavern, our source of food. It's blocked the entrance with a huge boulder!"
    
    darunia "Without food, my people will starve. I don't know what to do..."
    
    menu:
        darunia "Can you help us, Brother?"
        
        "I'll defeat the dragon!":
            link "I'll go to Dodongo's Cavern and defeat that dragon for you!"
            darunia "What?! You would do that for us? You're a true Brother!"
            
        "Tell me more about the dragon":
            link "What kind of dragon is it? What should I expect?"
            darunia "It's called King Dodongo. A massive beast with armor-like skin. Its roar alone can shake the mountain!"
    
    darunia "If you can defeat King Dodongo and open the cavern, I'll give you our most precious treasure, the Goron's Ruby!"
    
    link "I'll do it! Where is Dodongo's Cavern?"
    
    darunia "I'll show you, Brother. Follow me!"
    
    scene bg black
    with fade
    
    jump dodongo_cavern

label dodongo_cavern:
    scene bg dodongo_cavern
    with fade
    
    play music "audio/dodongo_cavern.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "This place is full of lava! Be careful, Link!"
    
    link "I can handle it. Let's find King Dodongo!"
    
    "Link explores the cavern..."
    
    scene bg black
    with fade
    
    "Link finds a treasure chest!"
    
    scene bg dodongo_cavern
    with fade
    
    show link child
    
    link "What's inside?"
    
    call item_get("Bomb Bag", "item_bombs")
    $ has_bomb_bag = True
    
    show navi at naviright
    
    navi "Bombs! You can use these to destroy cracked walls and boulders! They're also useful in battle!"
    
    link "Perfect! These will come in handy!"
    
    "Link navigates through the cavern, using bombs to destroy obstacles and defeat enemies..."
    
    scene bg black
    with fade
    
    "After solving puzzles and fighting through the dungeon..."
    
    scene bg dodongo_cavern
    with fade
    
    show link child
    show navi at naviright
    
    navi "I can hear something roaring ahead! That must be the boss chamber!"
    
    link "Let's finish this!"
    
    jump boss_king_dodongo

label boss_king_dodongo:
    scene bg dodongo_cavern
    with fade
    
    play music "audio/dodongo_boss_battle.mp3" if_changed
    
    show king_dodongo
    with dissolve
    
    "A massive dinosaur-like creature emerges from the lava!"
    
    show link child at midleft
    show navi at naviright
    
    navi "That's King Dodongo! Watch out for his fire breath!"
    
    $ dodongo_health = 3
    
    jump dodongo_battle

label dodongo_battle:
    if dodongo_health <= 0:
        jump dodongo_defeated
    
    show king_dodongo
    
    "King Dodongo opens his mouth wide, preparing to breathe fire!"
    
    menu:
        navi "What will you do?"
        
        "Use sword":
            link "I'll attack him directly!"
            play sound "sound/sword_slash.wav"
            "Link slashes at King Dodongo, but his thick hide deflects the blade!"
            navi "His skin is too tough! Try something else!"
            jump dodongo_battle
            
        "Throw a bomb":
            link "Let's use a bomb!"
            play sound "audio/bomb_toss.mp3"
            "Link throws a bomb into King Dodongo's open mouth!"
            play sound "audio/explosion.mp3"
            "The bomb explodes inside King Dodongo! He falls to the ground, stunned!"
            show king_dodongo at shake

            menu:
                navi "Quick! Attack while he's down!"
                
                "Strike with sword":
                    play sound "sound/sword_slash.wav"
                    "Link attacks King Dodongo's exposed belly repeatedly!"
                    show king_dodongo at shake
                    $ dodongo_health -= 1
                    play sound "sound/enemy_hit.wav"
                    
                    if dodongo_health > 0:
                        play sound "audio/enemy_hurt.mp3"
                        "King Dodongo roars in pain and gets back up!"
                        navi "Keep it up! [dodongo_health] more times!"
                        jump dodongo_battle
                    else:
                        jump dodongo_defeated
                        
                "Wait":
                    "Link hesitates and King Dodongo recovers!"
                    navi "You missed your chance!"
                    jump dodongo_battle

label dodongo_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "King Dodongo curls up and explodes in a massive blast!"
    
    hide king_dodongo
    
    show link child at midleft
    show navi at naviright
    
    navi "We did it! The cavern is safe now!"
    
    call item_get("Heart Container", "item_heart_container")
    
    "A blue light surrounds Link..."
    
    scene bg black
    with fade
    
    scene bg goron_city
    with fade
    
    play music "audio/death_mountain_theme.mp3" if_changed
    
    show link child at midleft
    show darunia_sprite at midright
    
    darunia "Brother! You did it! The cavern is open again!"
    
    "All the Gorons cheer!"
    
    darunia "You are a true hero, Brother! As promised, I give you the Goron's Ruby, the Spiritual Stone of Fire!"
    
    call item_get("Goron's Ruby", "item_goron_ruby")
    $ has_goron_ruby = True
    
    link "Thank you, Darunia. I'll protect it with my life!"
    
    darunia "I know you will, Brother. The Gorons will never forget what you've done for us!"
    
    navi "Link! We still need one more Spiritual Stone, the Zora's Sapphire!"
    
    link "You're right. Let's head to Zora's Domain!"
    
    scene bg black
    with fade
    
    jump hyrule_field_hub

label zora_domain_approach:
    scene bg zora_river
    with fade
    
    play music "audio/zora_domain_theme.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "This is Zora's River! The domain should be behind that waterfall!"
    
    link "How do we get through the waterfall?"
    
    navi "Try playing Zelda's Lullaby! It might open the path!"
    
    play sound "audio/zelda_lullaby.mp3"
    
    "Link plays Zelda's Lullaby..."
    
    play sound "audio/water_flow.mp3"
    
    "The waterfall parts, revealing a passage!"
    
    scene bg zora_domain
    with fade
    
    play music "audio/zora_domain_theme.mp3" if_changed
    
    show link child
    
    link "Wow! This place is beautiful!"
    
    show navi at naviright
    
    navi "It's an underwater paradise! Let's find the Zora leader!"
    
    "Zora Guard" "You! Small Hylian! King Zora wishes to see you immediately!"
    
    "Link is escorted to the throne room..."

    show link child at midleft
    with dissolve

    show king_zora at midcenter
    with dissolve
    
    king_zora "Hmm? You're not my daughter... Where is Princess Ruto?!"
    
    show navi at naviright
    
    navi "Princess Ruto? We haven't seen her!"
    
    king_zora "She went inside Lord Jabu-Jabu and hasn't returned! Something must be wrong!"
    
    king_zora "Please, young hero! Find my daughter! She's all I have!"
    
    link "Don't worry! I'll find her!"
    
    scene bg black
    with fade
    
    jump inside_jabu_jabu

label inside_jabu_jabu:
    scene bg jabu_jabu
    with fade
    
    play music "audio/jabu_jabu_belly.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "We're inside Lord Jabu-Jabu's belly! This is... gross."
    
    link "Let's just find Princess Ruto and get out of here."
    
    "Link explores the strange interior..."
    
    scene bg black
    with fade
    
    "Link finds a treasure chest!"
    
    scene bg jabu_jabu
    with fade
    
    show link child
    
    link "Another treasure!"
    
    call item_get("Boomerang", "item_boomerang")
    $ has_boomerang = True
    
    show navi at naviright
    
    navi "The Boomerang! You can stun enemies from a distance and retrieve distant items!"
    
    link "This will be helpful!"
    
    "Link continues exploring, fighting enemies and solving puzzles..."
    
    scene bg jabu_jabu
    with fade
    
    show link child
    show navi at naviright
    
    navi "Link! I sense someone ahead!"
    
    show ruto_sprite at midright
    with dissolve
    
    ruto "You! What are you doing here?!"
    
    link "Princess Ruto! Your father is worried about you!"
    
    ruto "Hmph! I don't need anyone's help! I came here to find something precious that I dropped."
    
    ruto "But... since you're here, you can carry me! I'm royalty, after all!"
    
    navi "Carry you?!"
    
    ruto "Yes! Now let's go! And watch your step, you're carrying a princess!"
    
    "Link reluctantly carries Princess Ruto through the dungeon..."
    
    scene bg black
    with fade
    
    "After more puzzles and battles..."
    
    scene bg jabu_jabu
    with fade
    
    show link child
    show ruto_sprite at midright
    
    ruto "There! That chamber ahead! That's where the boss must be!"
    
    navi "The boss? How do you know?"
    
    ruto "I can sense it! Now hurry up!"
    
    jump boss_barinade

label boss_barinade:
    scene bg jabu_jabu
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    show barinade
    with dissolve
    
    "A bio-electric anemone creature emerges!"
    
    show link child at midleft
    show navi at naviright
    
    navi "That's Barinade! Be careful of its electricity!"
    
    $ barinade_health = 3
    
    jump barinade_battle

label barinade_battle:
    if barinade_health <= 0:
        jump barinade_defeated
    
    show barinade
    
    navi "It's protected by those jellyfish! Cut them down first!"
    
    menu:
        "Use sword on jellyfish":
            play sound "sound/sword_slash.wav"
            "Link cuts down the Bari jellyfish protecting Barinade!"
            "Barinade's core is exposed!"
            
            menu:
                navi "Now hit the body with your boomerang to stun it!"
                
                "Use boomerang":
                    play sound "audio/boomerang.mp3"
                    "Link throws the boomerang at Barinade's body!"
                    play sound "audio/enemy_hit.mp3"
                    "Barinade is stunned!"
                    show barinade at shake
                    
                    menu:
                        navi "Attack with your sword!"
                        
                        "Strike with sword":
                            play sound "sound/sword_slash.wav"
                            "Link slashes at Barinade repeatedly!"
                            $ barinade_health -= 1
                            play sound "sound/enemy_hit.wav"
                            show barinade at shake
                            
                            if barinade_health > 0:
                                play sound "audio/enemy_hurt.mp3"
                                "Barinade recovers and summons more jellyfish!"
                                navi "[barinade_health] more times!"
                                jump barinade_battle
                            else:
                                jump barinade_defeated
                                
                        "Wait":
                            "Barinade recovers before Link can attack!"
                            jump barinade_battle
                            
                "Use sword":
                    "Link tries to hit with his sword but can't reach!"
                    navi "Use the boomerang!"
                    jump barinade_battle
                    
        "Attack Barinade directly":
            play sound "sound/sword_slash.wav"
            "The jellyfish block Link's attack!"
            navi "Take out the jellyfish first!"
            jump barinade_battle

label barinade_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Barinade convulses and explodes in a shower of sparks!"
    
    hide barinade
    
    show link child at midleft
    show navi at naviright
    play music "audio/zora_domain_theme.mp3" if_changed
    
    navi "Great job, Link!"
    
    call item_get("Heart Container", "item_heart_container")
    
    show ruto_sprite at midright
    
    ruto "You... you actually did it. You saved me."
    
    link "Of course! Let's get you back to your father."
    
    ruto "Wait. I need to give you something. It's why I came here in the first place."
    
    ruto "This is my most precious possession. My mother gave it to me..."
    
    call item_get("Zora's Sapphire", "item_zora_sapphire")
    $ has_zora_sapphire = True
    
    ruto "It's the Zora's Sapphire, the Spiritual Stone of Water. By giving this to you... it means we're engaged!"
    
    link "What?! Engaged?!"
    
    ruto "Don't forget me, Link. When we grow up, we'll be married!"
    
    navi "Oh boy..."
    
    scene bg black
    with fade
    
    scene bg zora_domain
    with fade
    
    king_zora "My daughter! You're safe! Thank you, young hero!"
    
    show link child
    show navi at naviright
    
    link "It was my honor, King Zora."
    
    navi "Link! You now have all three Spiritual Stones! We need to return to Princess Zelda!"
    
    link "You're right! Let's go back to Hyrule Castle!"
    
    scene bg black
    with fade
    
    jump return_to_castle

label return_to_castle:
    scene bg hyrule_field
    with fade
    
    play music "audio/ganondorf_theme.mp3" if_changed
    
    show link child
    
    "As Link approaches Hyrule Castle Town, something feels wrong..."
    
    "The sky is dark and smoke rises from the castle..."
    
    show navi at naviright
    
    navi "Link! Something terrible has happened!"
    
    if not (has_kokiri_emerald and has_goron_ruby and has_zora_sapphire):
        navi "Wait! We don't have all three Spiritual Stones yet!"
        
        if not has_goron_ruby:
            navi "We still need the Goron's Ruby from Death Mountain!"
        if not has_zora_sapphire:
            navi "We still need the Zora's Sapphire from Zora's Domain!"
        if not has_kokiri_emerald:
            navi "We still need the Kokiri's Emerald from the Deku Tree!"
        
        navi "We should complete our quest before going to the castle!"
        jump hyrule_field_hub
    
    "Suddenly, a horse gallops toward Link!"
    
    show link child at midleft
    with dissolve
    show impa_sprite at midcenter
    with dissolve
    show zelda child at midright
    
    impa "Link! You must get away from here!"
    
    zelda "Link! Take this!"
    
    "Zelda throws something into the moat!"
    
    play sound "audio/splash.mp3"
    
    zelda "Don't let Ganondorf get the Triforce!"
    
    hide zelda child
    hide impa_sprite
    with dissolve
    
    "The horse races away..."
    
    show ganondorf_sprite
    with dissolve
    
    ganondorf "You! Boy! Did you see a girl on horseback pass by here?"
    
    link "..."
    
    ganondorf "Hmph. No matter. She cannot escape her fate. And neither can you..."
    
    "Ganondorf conjures a dark energy ball and throws it at Link!"
    
    play sound "audio/dark_magic.mp3"
    
    "Link barely dodges!"
    
    ganondorf "Stay out of my way, child. Or you will die."
    
    hide ganondorf_sprite
    with dissolve
    
    navi "Link! Are you okay?!"
    
    link "I'm fine... but what did Zelda throw?"
    
    "Link dives into the moat and retrieves it..."
    
    call item_get("Ocarina of Time", "item_ocarina_of_time")
    $ has_ocarina_of_time = True
    
    "A vision appears before Link..."
    
    show zelda child at midcenter
    
    zelda "Link... if you're seeing this, then I've failed to protect Hyrule."
    
    zelda "You must go to the Temple of Time. Play the Song of Time to open the Door of Time."
    
    play sound "audio/song_of_time.mp3"
    
    "Zelda teaches Link the Song of Time..."
    
    zelda "Inside, you will find the Master Sword, the blade of evil's bane. Draw the sword and seal Ganondorf away!"
    
    zelda "Please, Link... you're Hyrule's only hope now."
    
    hide zelda child
    
    navi "Link... we have to go to the Temple of Time!"
    
    link "Let's go. We can't let Ganondorf win!"
    
    scene bg black
    with fade
    
    jump temple_of_time_first

label temple_of_time_first:
    scene bg temple_of_time
    with fade
    
    play music "audio/temple_of_time_theme.mp3" if_changed
    
    show link child
    show navi at naviright
    
    navi "This is the Temple of Time... It feels ancient and sacred."
    
    link "There's the Door of Time. And... those three holes must be for the Spiritual Stones!"
    
    "Link places the Kokiri's Emerald, Goron's Ruby, and Zora's Sapphire in their pedestals..."
    
    play sound "audio/stones_activate.mp3"
    
    "The three stones begin to glow!"
    
    link "Now I'll play the Song of Time!"
    
    play sound "audio/song_of_time.mp3"
    
    "Link plays the Song of Time on the Ocarina of Time..."
    
    play sound "audio/door_open_heavy.mp3"
    
    "The Door of Time slowly opens, revealing a chamber beyond..."
    
    scene bg sacred_realm
    with fade
    
    play music "audio/master_sword_theme.mp3" if_changed
    
    show link child
    
    "In the center of the chamber, bathed in light, rests a legendary sword..."
    
    link "The Master Sword..."
    
    show navi at naviright
    
    navi "Link, this is it. This is your destiny."
    
    menu:
        navi "Are you ready to draw the Master Sword?"
        
        "Yes, I'm ready":
            link "This is what I was meant to do. For Hyrule... for everyone!"
            
        "What will happen when I draw it?":
            link "I feel like something big is about to happen..."
            navi "There's only one way to find out, Link. Trust in your destiny."
    
    "Link grasps the hilt of the Master Sword..."
    
    play sound "audio/sword_draw.mp3"
    
    "He pulls with all his might!"
    
    "The Master Sword slides free from its pedestal!"
    
    call item_get("Master Sword", "item_master_sword")
    
    $ has_master_sword = True
    
    "A blinding light fills the chamber!"
    
    scene bg white
    with fade
    
    play sound "audio/time_warp.mp3"
    
    "Link's body begins to float..."
    
    rauru "Link... can you hear me?"
    
    scene bg sacred_realm
    with fade
    
    show rauru at midcenter
    
    rauru "I am Rauru, one of the Seven Sages. Welcome to the Sacred Realm."
    
    rauru "When you drew the Master Sword, the door to the Sacred Realm opened... but you were too young to be the Hero of Time."
    
    rauru "Your spirit was sealed away for seven years, until you became old enough to wield the blade."
    
    rauru "Link... seven years have passed in the world outside."
    
    "Link looks down at his hands, they're larger, adult hands..."
    
    rauru "Ganondorf followed you into the Sacred Realm and took the Triforce... or part of it."
    
    rauru "The Triforce split into three pieces. Ganondorf claimed the Triforce of Power. Princess Zelda received the Triforce of Wisdom."
    
    rauru "And you, Link, possess the Triforce of Courage."
    
    rauru "For seven years, Ganondorf has ruled Hyrule with an iron fist, covering the land in darkness."
    
    rauru "You must awaken the other five Sages. Only then will you have the power to seal Ganondorf away!"
    
    rauru "Go now, Hero of Time! Save Hyrule!"
    
    scene bg white
    with fade
    
    play sound "audio/time_warp.mp3"
    
    $ is_adult = True
    
    jump awakening_adult

label awakening_adult:
    scene bg temple_of_time
    with fade
    
    play music "audio/temple_of_time_theme.mp3" if_changed
    
    show link adult
    with dissolve
    
    "Link awakens in the Temple of Time..."
    
    show navi at naviright
    
    navi "Link... you're... you're all grown up!"
    
    link "Seven years... Seven years have passed... What has happened to Hyrule?"
    
    navi "There's only one way to find out. Let's go outside."
    
    scene bg black
    with fade
    
    jump hyrule_field_adult

label hyrule_field_adult:
    scene bg hyrule_field
    with fade
    
    play music "audio/hyrule_field_theme.mp3" if_changed
    
    show link adult
    
    "The sky is dark and foreboding. Monsters roam freely..."
    
    show navi at naviright
    
    navi "Link... Hyrule has changed so much. It's covered in darkness!"
    
    link "This is what Ganondorf has done... We have to stop him!"

    show link adult at midleft
    with dissolve

    show sheik_sprite at midcenter
    with dissolve
    
    play sound "audio/warp_in.mp3"
    
    sheik "Link..."
    
    link "Who are you?"
    
    sheik "I am Sheik, survivor of the Sheikah tribe. I have been waiting for you, Hero of Time."
    
    link "You know who I am?"
    
    sheik "I know many things. I know that you must awaken the Five Sages to defeat Ganondorf."
    
    sheik "The Forest Sage sleeps in the Forest Temple, deep within the Lost Woods."
    
    sheik "The Fire Sage awaits in the Fire Temple on Death Mountain."
    
    sheik "The Water Sage is imprisoned in the Water Temple beneath Lake Hylia."
    
    sheik "The Shadow Sage lies in the Shadow Temple in Kakariko Village."
    
    sheik "And the Spirit Sage dwells in the Spirit Temple in the Desert."
    
    navi "Five temples! That's a lot of work!"
    
    sheik "Time is not on your side, Link. Ganondorf grows stronger each day. You must hurry."
    
    "Sheik teaches Link the Prelude of Light..."
    
    play sound "audio/prelude_of_light.mp3"
    
    sheik "Play this song to return to the Temple of Time whenever you need."
    
    sheik "May the goddess smile upon you."
    
    hide sheik_sprite
    with dissolve
    
    play sound "audio/warp_out.mp3"
    
    link "Wait!"
    
    navi "They're gone... But Link, we have our mission! Let's start with the Forest Temple!"
    
    jump adult_temple_hub

label adult_temple_hub:
    if (has_forest_medallion and has_fire_medallion and has_water_medallion):
        navi "Link! We've awakened the first three Sages! We need to find the Shadow and Spirit Temples next!"
        jump adult_temple_hub_2
    else:
        scene bg hyrule_field
        show link adult at midleft
        with dissolve
        show navi at naviright
        
        menu:
            navi "Which temple should we tackle first, Link?"
            
            "Forest Temple":
                if not has_forest_medallion:
                    navi "Back to the forest! Let's awaken the Forest Sage!"
                    jump forest_temple_approach
                else:
                    navi "We already have the Forest Medallion! Let's choose another temple."
                    jump adult_temple_hub
                
            "Fire Temple":
                if not has_fire_medallion:
                    navi "Death Mountain it is! To the Fire Temple!"
                    jump fire_temple_approach
                else:
                    navi "We already have the Fire Medallion! Let's choose another temple."
                    jump adult_temple_hub
                
            "Water Temple":
                if not has_water_medallion:
                    navi "Lake Hylia and the Water Temple await!"
                    jump water_temple_approach
                else:
                    navi "We already have the Water Medallion! Let's choose another temple."
                    jump adult_temple_hub

label forest_temple_approach:
    scene bg kokiri_forest
    with fade
    
    play music "audio/inside_deku_tree.mp3" if_changed
    
    show link adult
    
    "Link returns to Kokiri Forest... but everything has changed."
    
    "Monsters lurk in the shadows. The once cheerful forest is now dark and twisted."
    
    show navi at naviright
    
    navi "The forest... it's suffering under Ganondorf's curse!"

    link "Why is everything a monster here?"

    link "What happened to all my friends?."

    navi "Link..."

    link "..."
    
    link "We have to save it. Let's find the Forest Temple."
    
    "Link navigates through the Lost Woods and finds the Sacred Forest Meadow..."
    
    scene bg forest_temple
    with fade
    
    play music "audio/forest_temple_theme.mp3" if_changed
    
    "An ancient temple stands before him, covered in vines and darkness..."
    
    show link adult
    
    link "The Forest Temple. Let's go, Navi."
    
    "Link enters the temple..."
    
    scene bg black
    with fade
    
    "Link finds a treasure chest!"
    
    scene bg forest_temple
    with fade
    
    show link adult
    
    link "The Fairy Bow!"
    
    call item_get("Fairy Bow", "item_bow")
    $ has_fairy_bow = True
    
    show navi at naviright
    
    navi "You can shoot arrows at distant enemies! This will be essential for this temple!"
    
    "Link battles through Stalfos, Poe Sisters, and twisted corridors..."
    
    scene bg black
    with fade
    
    "After conquering the temple's challenges..."
    
    scene bg forest_temple
    with fade
    
    show link adult
    show navi at naviright
    
    navi "The boss chamber is ahead! I can sense a powerful presence!"
    
    jump boss_phantom_ganon

label boss_phantom_ganon:
    scene bg forest_temple
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    show phantom_ganon
    with dissolve
    
    "A phantom image of Ganondorf on horseback appears!"
    
    show link adult at midleft
    show navi at naviright
    
    navi "It's Phantom Ganon! A ghost created by Ganondorf himself!"
    
    $ phantom_ganon_health = 3
    
    jump phantom_ganon_battle

label phantom_ganon_battle:
    if phantom_ganon_health <= 0:
        jump phantom_ganon_defeated
    
    show phantom_ganon
    
    "Phantom Ganon rides through paintings, emerging to attack!"
    
    menu:
        navi "He's charging through the painting! What will you do?"
        
        "Shoot with bow":
            play sound "audio/bow_shot.mp3"
            "Link shoots an arrow at Phantom Ganon as he emerges!"
            play sound "audio/enemy_hit.mp3"
            "Direct hit! Phantom Ganon falls from his horse!"
            show phantom_ganon at shake
            
            "Phantom Ganon begins firing energy balls!"
            
            menu:
                navi "Deflect his magic back at him!"
                
                "Swing sword at energy ball":
                    play sound "sound/sword_slash.wav"
                    "Link deflects the energy ball!"
                    "Phantom Ganon hits it back!"
                    "Link deflects it again!"
                    play sound "audio/enemy_hit.mp3"
                    "The energy ball strikes Phantom Ganon!"
                    $ phantom_ganon_health -= 1
                    play sound "sound/enemy_hit.wav"
                    show phantom_ganon at shake
                    
                    if phantom_ganon_health > 0:
                        play sound "audio/enemy_hurt.mp3"
                        "Phantom Ganon recovers and mounts his horse again!"
                        navi "[phantom_ganon_health] more times!"
                        jump phantom_ganon_battle
                    else:
                        jump phantom_ganon_defeated
                        
                "Dodge":
                    "Link dodges but misses the opportunity to counter!"
                    navi "You have to hit it back!"
                    jump phantom_ganon_battle
                    
        "Use sword":
            play sound "sound/sword_slash.wav"
            "Link swings but Phantom Ganon is too far away!"
            navi "Use your bow!"
            if phantom_ganon_battle_ganon_health > 0:
                play sound "audio/enemy_hurt.mp3"
                "Phantom Ganon recovers and mounts his horse again!"
                navi "[phantom_ganon_health] more times!"
                jump phantom_ganon_battle
            else:
                jump phantom_ganon_defeated
                
        "Dodge":
            "Link dodges but misses the opportunity to counter!"
            navi "You have to hit it back!"
            jump phantom_ganon_battle
                    
        "Use sword":
            play sound "sound/sword_slash.wav"
            "Link swings but Phantom Ganon is too far away!"
            navi "Use your bow!"
            jump phantom_ganon_battle

label phantom_ganon_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Phantom Ganon screams and is dragged into a dark portal!"
    
    hide phantom_ganon
    
    show link adult at midleft
    show navi at naviright
    
    navi "We did it!"
    
    call item_get("Heart Container", "item_heart_container")
    
    "A pillar of green light appears..."
    
    hide navi

    show saria_sprite at midright
    with dissolve
    
    play music "audio/saria_song.mp3" if_changed
    
    saria "Link... you did it. You saved the forest."
    
    link "Saria! You're the Forest Sage!"
    
    saria "Yes. I've been waiting here all these years, hoping you would return."
    
    saria "Thank you for awakening me, Link. Now I can use my power to help you."
    
    play sound "audio/sage_awakening.mp3"
    
    "Saria awakens as the Sage of Forest!"
    
    saria "Take this, Link. It's my power as a Sage."
    
    call item_get("Forest Medallion", "item_forest_medallion")
    $ has_forest_medallion = True
    
    saria "Four more Sages remain. When all five are awakened, you'll have the power to face Ganondorf."
    
    saria "Link... I'll always be your friend. No matter what happens."
    
    link "Thank you, Saria. I'll finish this, I promise."
    
    hide saria_sprite
    
    "The green light surrounds Link and warps him out..."
    
    scene bg black
    with fade
    
    jump adult_temple_hub

label adult_temple_hub_2:
    scene bg hyrule_field
    show link adult
    show navi at naviright

    play music "audio/hyrule_field_theme.mp3" if_changed
    
    if has_shadow_medallion or has_spirit_medallion:
        navi "Link! just 1 Sage left. We can do this!"

    menu:
        navi "Where to next?"

        "Shadow Temple":
            if not has_shadow_medallion:
                navi "Kakariko Village and the Shadow Temple next!"
                jump shadow_temple_approach
            else:
                navi "We already have the Shadow Medallion! Let's choose another temple."
                jump adult_temple_hub_2

        "Spirit Temple":
            if not has_spirit_medallion:
                navi "The Desert and the Spirit Temple await!"
                jump spirit_temple_approach
            else:
                navi "We already have the Spirit Medallion! Let's choose another temple."
                jump adult_temple_hub_2


label fire_temple_approach:
    scene bg death_mountain
    with fade
    
    play music "audio/death_mountain_theme.mp3" if_changed
    
    show link adult
    
    "Death Mountain is more treacherous than ever..."
    
    show navi at naviright
    
    navi "The volcano is acting up! Ganondorf's influence, no doubt!"
    
    scene bg goron_city
    with fade
    
    play music "audio/death_mountain_theme.mp3" if_changed
    
    show link adult
    
    "The Goron City is frozen solid! Gorons are trapped in ice!"
    
    show navi at naviright
    
    navi "Link! The Gorons are frozen! What happened here?"
    
    "One unfrozen Goron speaks..."
    
    "Goron" "Link! Is that you? You're all grown up! Ganondorf has imprisoned our brothers in the Fire Temple!"
    
    "Goron" "Darunia went to save them, but he never returned! Please, help him!"
    
    link "I'll save them all. Don't worry!"
    
    scene bg fire_temple
    with fade
    
    play music "audio/fire_temple_theme.mp3" if_changed
    
    show link adult
    show navi at naviright
    
    navi "The Fire Temple! Be careful, Link, it's even hotter than before!"
    
    "Link explores the temple..."
    
    scene bg black
    with fade
    
    "Link finds a large treasure chest!"
    
    scene bg fire_temple
    with fade
    
    show link adult
    
    link "This is heavy!"
    
    call item_get("Megaton Hammer", "item_megaton_hammer")
    $ has_megaton_hammer = True
    
    show navi at naviright
    
    navi "The Megaton Hammer! You can smash rusted switches and pound stakes into the ground! It's also a powerful weapon!"
    
    link "This will be useful against the boss!"
    
    "Link battles through the temple, freeing Gorons and solving fire based puzzles..."
    
    scene bg black
    with fade
    
    "After rescuing all the Gorons..."
    
    scene bg fire_temple
    with fade
    
    show link adult
    show navi at naviright
    
    navi "The boss chamber is ahead! Let's finish this!"
    
    jump boss_volvagia

label boss_volvagia:
    scene bg fire_temple
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    "The ground shakes! A massive dragon emerges from the lava!"
    
    show volvagia
    with dissolve
    
    show link adult at midleft
    show navi at naviright
    
    navi "That's Volvagia! The ancient dragon of the mountain!"
    
    $ volvagia_health = 3
    
    jump volvagia_battle

label volvagia_battle:
    if volvagia_health <= 0:
        jump volvagia_defeated
    
    show volvagia
    
    "Volvagia emerges from a hole in the ground, breathing fire!"
    
    menu:
        navi "Quick! What will you do?"
        
        "Use sword":
            link "I'll strike her!"
            play sound "sound/sword_slash.wav"
            "Link slashes at Volvagia, but she flies out of reach!"
            navi "Wait for her to come out of the holes!"
            jump volvagia_battle
            
        "Use Megaton Hammer":
            link "Take this!"
            play sound "audio/hammer_smash.mp3"
            "Link slams the Megaton Hammer on Volvagia's head!"
            play sound "audio/enemy_hit.mp3"
            show volvagia at shake
            "Volvagia crashes to the ground, stunned!"
            
            menu:
                navi "Attack while she's down!"
                
                "Strike with sword":
                    play sound "sound/sword_slash.wav"
                    "Link slashes repeatedly at Volvagia's vulnerable body!"
                    $ volvagia_health -= 1
                    play sound "sound/enemy_hit.wav"
                    show volvagia at shake
                    
                    if volvagia_health > 0:
                        play sound "audio/enemy_hurt.mp3"
                        "Volvagia roars and retreats back into the lava!"
                        navi "Keep it up! [volvagia_health] more times!"
                        jump volvagia_battle
                    else:
                        jump volvagia_defeated
                        
                "Wait":
                    "Volvagia recovers and flies away!"
                    navi "Too slow!"
                    jump volvagia_battle

label volvagia_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Volvagia lets out a final roar and crumbles into ash!"
    
    hide volvagia
    
    show link adult at midleft
    show navi at naviright
    
    navi "You did it! The Fire Temple is free!"
    
    call item_get("Heart Container", "item_heart_container")
    
    "A pillar of red light appears..."
    
    show darunia_sprite at midright
    with dissolve
    
    play music "audio/death_mountain_theme.mp3" if_changed
    
    darunia "Brother! You came for me!"
    
    link "Darunia! Are you alright?"
    
    darunia "Thanks to you, Brother! I thought I was done for!"
    
    darunia "Link... I understand now. I am the Sage of Fire. It's time for me to fulfill my duty."
    
    play sound "audio/sage_awakening.mp3"
    
    "Darunia awakens as the Sage of Fire!"
    
    darunia "Take my power, Brother! Use it to defeat Ganondorf!"
    
    call item_get("Fire Medallion", "item_fire_medallion")
    $ has_fire_medallion = True
    
    darunia "You've always been a true Brother to me and my people. Now go! Awaken the other Sages!"
    
    link "Thank you, Darunia. The Gorons are safe now!"
    
    hide darunia_sprite
    
    scene bg black
    with fade
    
    jump adult_temple_hub


label water_temple_approach:
    scene bg lake_hylia
    with fade
    
    play music "audio/hyrule_field_morning.mp3" if_changed
    
    show link adult
    
    "Lake Hylia's water level has dropped dramatically..."
    
    show navi at naviright
    
    navi "The lake is almost dry! Something's wrong at the Water Temple!"

    show link adult at midleft
    with dissolve

    show sheik_sprite at midcenter
    with dissolve
    
    play sound "audio/warp_in.mp3"
    
    sheik "Link. The Water Temple lies beneath the lake."
    
    sheik "You'll need the Iron Boots to sink to the bottom. I sense you already have them."
    
    sheik "Learn this song, it will help you control the water."
    
    play sound "audio/serenade_of_water.mp3"
    
    "Sheik teaches Link the Serenade of Water..."
    
    sheik "The Water Temple is treacherous. Watch your step."
    
    hide sheik_sprite
    with dissolve
    
    play sound "audio/warp_out.mp3"
    
    "Link dives into the lake with his Iron Boots..."
    
    scene bg water_temple
    with fade
    
    play music "audio/water_temple_theme.mp3" if_changed
    
    show link adult
    show navi at naviright
    
    navi "This place is like a maze! And everything is flooded!"
    
    link "We need to raise and lower the water to progress. Let's go!"
    
    "Link explores the temple..."
    
    scene bg black
    with fade
    
    "Link finds a treasure chest!"
    
    scene bg water_temple
    with fade
    
    show link adult
    
    link "What's this?"
    
    call item_get("Longshot", "item_longshot")
    $ has_longshot = True
    
    show navi at naviright
    
    navi "The Longshot! It's an upgraded Hookshot that can reach twice as far! Perfect for this temple!"
    
    link "This will make navigating easier!"
    
    "Link navigates the complex Water Temple, adjusting water levels and battling Dark Link..."
    
    scene bg black
    with fade
    
    "After conquering the temple's many challenges..."
    
    scene bg water_temple
    with fade
    
    show link adult
    show navi at naviright
    
    navi "I can sense the boss ahead! Let's finish this!"
    
    jump boss_morpha

label boss_morpha:
    scene bg water_temple
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    "The water in the chamber ripples ominously..."
    
    show morpha
    with dissolve
    
    "A giant amoeba-like creature with a nucleus inside appears!"
    
    show link adult at midleft
    show navi at naviright
    
    navi "That's Morpha! The nucleus is its weak point!"
    
    $ morpha_health = 3
    
    jump morpha_battle

label morpha_battle:
    if morpha_health <= 0:
        jump morpha_defeated
    
    show morpha
    
    "Morpha's nucleus swims through the water, controlling tentacles!"
    
    menu:
        navi "Grab the nucleus with your Longshot!"
        
        "Use Longshot":
            play sound "audio/longshot.mp3"
            "Link shoots the Longshot at the nucleus!"
            play sound "audio/grab.mp3"
            show morpha at shake
            "Got it! Link pulls the nucleus out of the water!"
            
            menu:
                navi "Attack it now!"
                
                "Strike with sword":
                    play sound "sound/sword_slash.wav"
                    "Link slashes at the vulnerable nucleus!"
                    $ morpha_health -= 1
                    play sound "sound/enemy_hit.wav"
                    show morpha at shake
                    
                    if morpha_health > 0:
                        play sound "audio/enemy_hurt.mp3"
                        "The nucleus escapes back into the water!"
                        navi "[morpha_health] more times!"
                        jump morpha_battle
                    else:
                        jump morpha_defeated
                        
                "Wait":
                    "The nucleus breaks free and returns to the water!"
                    navi "You have to hit it quickly!"
                    jump morpha_battle
                    
        "Use sword":
            play sound "sound/sword_slash.wav"
            "Link's sword can't reach the nucleus in the water!"
            navi "Use the Longshot!"
            jump morpha_battle

label morpha_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Morpha's nucleus shrivels and dissolves into nothing!"
    
    hide morpha
    
    show link adult at midleft
    show navi at naviright
    
    navi "Great job! The water is purified!"
    
    call item_get("Heart Container", "item_heart_container")
    
    "A pillar of blue light appears..."
    
    show ruto_sprite at midright
    with dissolve
    
    play music "audio/zora_domain_theme.mp3" if_changed
    
    ruto "Link... you came back. Just like you promised."
    
    link "Princess Ruto! You're the Water Sage!"
    
    ruto "Yes. I've been waiting here, keeping the Water Temple safe from Ganondorf."
    
    ruto "Link... do you remember? When we were children, I said we'd be married."
    
    link "Uh... yes, I remember..."
    
    ruto "I'm sorry, Link. As a Sage, I have responsibilities I cannot abandon. Our engagement... it cannot be."
    
    ruto "But I will always treasure our time together. You'll always be special to me."
    
    play sound "audio/sage_awakening.mp3"
    
    "Ruto awakens as the Sage of Water!"
    
    call item_get("Water Medallion", "item_water_medallion")
    $ has_water_medallion = True
    
    ruto "Go, Link. Two more Sages await. Save Hyrule!"
    
    link "I will. Thank you, Ruto."
    
    hide ruto_sprite
    
    scene bg black
    with fade
    
    jump adult_temple_hub

label shadow_temple_approach:
    scene bg kakariko_village
    with fade
    
    play music "audio/kakariko_theme.mp3" if_changed
    
    show link adult
    
    "Kakariko Village is in flames! Monsters attack the villagers!"
    
    show navi at naviright
    
    navi "Link! The village is under attack!"
    
    "Link defends the village from the monsters..."

    show link adult at midleft
    with dissolve
    
    show sheik_sprite at midcenter
    with dissolve
    
    play sound "audio/warp_in.mp3"
    
    sheik "Link. This attack was Ganondorf's doing. He seeks to prevent you from awakening the Sages."
    
    sheik "The Shadow Temple lies in the graveyard. It is a place of death and darkness."
    
    sheik "You'll need the Eye of Truth to see through illusions. I believe you obtained it in the Bottom of the Well."
    
    play sound "audio/nocturne_of_shadow.mp3"
    
    "Sheik teaches Link the Nocturne of Shadow..."
    
    sheik "This song will take you to the temple entrance. Be brave, Link. The shadows hold many terrors."
    
    hide sheik_sprite
    with dissolve
    
    play sound "audio/warp_out.mp3"
    
    show impa_sprite at midcenter
    with dissolve
    
    impa "Link... it's been seven years. You've grown strong."
    
    link "Impa! Where have you been?"
    
    impa "Protecting the Shadow Temple, waiting for you. I am the Shadow Sage."
    
    impa "But I need you to cleanse the temple of evil. Only then can I fully awaken."
    
    link "I'll do it. I'll cleanse the Shadow Temple!"
    
    hide impa_sprite
    
    scene bg shadow_temple
    with fade
    
    play music "audio/shadow_temple_theme.mp3" if_changed
    
    show link adult
    show navi at naviright
    
    navi "This place gives me the creeps... Stay alert, Link!"
    
    "Link explores the temple..."
    
    scene bg black
    with fade
    
    "Link finds a treasure chest!"
    
    scene bg shadow_temple
    with fade
    
    show link adult
    
    link "Hover Boots!"
    
    call item_get("Hover Boots", "item_hover_boots")
    $ has_hover_boots = True
    
    show navi at naviright
    
    navi "The Hover Boots! You can walk on air for a short time! Perfect for crossing gaps!"
    
    link "These will help us navigate this place!"
    
    "Link explores the dark Shadow Temple, using the Eye of Truth to reveal hidden paths..."
    
    scene bg black
    with fade
    
    "After battling through horrors and solving puzzles..."
    
    scene bg shadow_temple
    with fade
    
    show link adult
    show navi at naviright
    
    navi "The boss is near! I can feel it!"
    
    jump boss_bongo_bongo

label boss_bongo_bongo:
    scene bg shadow_temple
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    "A giant drum beats in the darkness!"
    
    show bongo_bongo
    with dissolve
    
    "A massive invisible creature appears, only its hands and head visible!"
    
    show link adult at midleft
    show navi at naviright
    
    navi "Bongo Bongo! Use the Eye of Truth to see it!"
    
    $ bongo_health = 3
    
    jump bongo_battle

label bongo_battle:
    if bongo_health <= 0:
        jump bongo_defeated
    
    show bongo_bongo
    
    "Bongo Bongo beats its drum, making the platform shake!"
    
    menu:
        navi "Activate the Eye of Truth!"
        
        "Use Eye of Truth":
            "Link activates the Eye of Truth and sees Bongo Bongo's true form!"
            
            menu:
                navi "Shoot its hands with arrows to stun it!"
                
                "Shoot both hands":
                    play sound "audio/bow_shot.mp3"
                    "Link shoots one hand!"
                    play sound "audio/bow_shot.mp3"
                    "Then shoots the other hand!"
                    play sound "audio/enemy_hit.mp3"
                    "Bongo Bongo's eye is exposed!"
                    show bongo_bongo at shake
                    
                    menu:
                        navi "Shoot the eye!"
                        
                        "Shoot the eye":
                            play sound "audio/bow_shot.mp3"
                            "Link shoots an arrow directly into the eye!"
                            play sound "audio/enemy_hit.mp3"
                            "Bongo Bongo falls to the platform, stunned!"
                            show bongo_bongo at shake
                            
                            menu:
                                navi "Attack with your sword!"
                                
                                "Strike with sword":
                                    play sound "sound/sword_slash.wav"
                                    "Link slashes at Bongo Bongo!"
                                    $ bongo_health -= 1
                                    play sound "sound/enemy_hit.wav"
                                    show bongo_bongo at shake
                                    
                                    if bongo_health > 0:
                                        play sound "audio/enemy_hurt.mp3"
                                        "Bongo Bongo recovers and becomes invisible again!"
                                        navi "[bongo_health] more times!"
                                        jump bongo_battle
                                    else:
                                        jump bongo_defeated
                                        
                                "Wait":
                                    "Bongo Bongo recovers!"
                                    jump bongo_battle
                                    
                        "Use sword":
                            "Too far away to hit with sword!"
                            navi "Shoot it!"
                            jump bongo_battle
                            
                "Attack the body":
                    "The hands block Link's attacks!"
                    navi "Hit the hands first!"
                    jump bongo_battle
                    
        "Attack blindly":
            play sound "sound/sword_slash.wav"
            "Link swings at nothing!"
            navi "Use the Eye of Truth to see it!"
            jump bongo_battle

label bongo_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Bongo Bongo lets out a final wail and dissolves into shadow!"
    
    hide bongo_bongo
    
    show link adult at midleft
    show navi at naviright
    
    navi "That was terrifying! But we won!"
    
    call item_get("Heart Container", "item_heart_container")
    
    "A pillar of purple light appears..."
    
    show impa_sprite at midright
    with dissolve
    
    play music "audio/zelda_theme.mp3" if_changed
    
    hide navi

    impa "Link. You have done well. The Shadow Temple is cleansed."
    
    link "Impa! I'm glad you're safe!"
    
    impa "I am the Sage of Shadow. It is my duty to guard the temple and protect Princess Zelda."
    
    play sound "audio/sage_awakening.mp3"
    
    "Impa awakens as the Sage of Shadow!"
    
    impa "Link, I must tell you something about Sheik..."
    
    link "What about Sheik?"
    
    impa "All will be revealed in time. For now, take my power."
    
    call item_get("Shadow Medallion", "item_shadow_medallion")
    $ has_shadow_medallion = True
    
    impa "One Sage remains. Go to the Spirit Temple in the desert. Complete your quest!"
    
    link "I will. Thank you, Impa!"
    
    hide impa_sprite
    
    scene bg black
    with fade
    
    jump adult_temple_hub_2

label spirit_temple_approach:
    scene bg hyrule_field
    with fade
    
    play music "audio/gerudo_valley_theme.mp3" if_changed
    
    show link adult
    show navi at naviright
    
    navi "The desert! This is it, the final temple!"
    
    "Link travels across the desert to the Spirit Temple..."
    
    scene bg spirit_temple
    with fade
    
    play music "audio/spirit_temple_theme.mp3" if_changed
    
    show link adult
    
    "A massive temple carved from stone rises from the sand..."
    
    show navi at naviright
    
    navi "The Spirit Temple! But look, it has areas only a child can enter!"
    
    show link adult at midleft
    with dissolve

    show sheik_sprite at midcenter
    with dissolve
    
    play sound "audio/warp_in.mp3"
    
    sheik "Link. This temple requires both child and adult to complete."
    
    sheik "You must return to your child form, navigate the child areas, then return as an adult."
    
    play sound "audio/requiem_of_spirit.mp3"
    
    "Sheik teaches Link the Requiem of Spirit..."
    
    sheik "Use the Master Sword's pedestal to travel through time. Good luck, Hero of Time."
    
    hide sheik_sprite
    with dissolve
    
    play sound "audio/warp_out.mp3"
    
    link "I need to go back to the Temple of Time and become a child again!"
    
    scene bg black
    with fade
    
    "Link returns to the Temple of Time and places the Master Sword back..."
    
    play sound "audio/time_warp.mp3"
    
    "Link becomes a child again!"
    
    scene bg spirit_temple
    with fade
    
    show link child
    show navi at naviright
    
    navi "Now we can explore the child areas!"
    
    "Link solves puzzles in the child sections..."
    
    scene bg black
    with fade
    
    "After completing the child portions, Link returns to the Temple of Time..."
    
    play sound "audio/time_warp.mp3"
    
    "Link draws the Master Sword and becomes an adult again!"
    
    scene bg spirit_temple
    with fade
    
    show link adult
    show navi at naviright
    
    navi "Now we can reach the boss chamber!"
    
    "Link completes the adult sections and reaches the boss door..."
    
    jump boss_twinrova

label boss_twinrova:
    scene bg spirit_temple
    with fade
    
    play music "audio/boss_battle.mp3" if_changed
    
    show twinrova
    with dissolve
    
    "Two witches appear, one surrounds herself in fire, the other in ice!"
    
    show link adult at midleft
    show navi at naviright
    
    navi "Kotake and Koume, the Twinrova witches! They serve Ganondorf!"
    
    $ twinrova_health = 3
    
    jump twinrova_battle

label twinrova_battle:
    if twinrova_health <= 0:
        jump twinrova_defeated
    
    show twinrova
    
    "The twin witches attack with fire and ice magic!"
    
    menu:
        navi "Use the Mirror Shield to reflect their magic!"
        
        "Reflect fire magic":
            play sound "audio/magic_reflect.mp3"
            "Link reflects the fire magic with his Mirror Shield!"
            "The fire magic hits the ice witch!"
            play sound "audio/enemy_hit.mp3"
            show twinrova at shake
            "The ice witch recoils in pain!"
            
            "After enough hits, the witches combine into one being!"
            
            menu:
                navi "They've fused! Absorb their magic and fire it back!"
                
                "Absorb three fire attacks":
                    play sound "audio/magic_absorb.mp3"
                    "Link absorbs three fire attacks!"
                    play sound "audio/magic_release.mp3"
                    "The magic fires back at Twinrova!"
                    play sound "audio/enemy_hit.mp3"
                    show twinrova at shake
                    "Direct hit! Twinrova crashes to the ground!"
                    
                    menu:
                        navi "Strike with your sword!"
                        
                        "Attack with sword":
                            play sound "sound/sword_slash.wav"
                            "Link slashes at the fallen Twinrova!"
                            $ twinrova_health -= 1
                            play sound "sound/enemy_hit.wav"
                            show twinrova at shake
                            
                            if twinrova_health > 0:
                                play sound "audio/enemy_hurt.mp3"
                                "Twinrova gets back up!"
                                navi "[twinrova_health] more times!"
                                jump twinrova_battle
                            else:
                                jump twinrova_defeated
                                
                        "Wait":
                            "Twinrova recovers!"
                            jump twinrova_battle
                            
                "Absorb ice attacks":
                    play sound "audio/magic_absorb.mp3"
                    "Link absorbs ice magic and releases it!"
                    play sound "audio/enemy_hit.mp3"
                    "It works the same way!"
                    $ twinrova_health -= 1
                    play sound "sound/enemy_hit.wav"
                    show twinrova at shake
                    
                    if twinrova_health > 0:
                        navi "[twinrova_health] more!"
                        jump twinrova_battle
                    else:
                        jump twinrova_defeated
                        
        "Attack directly":
            play sound "sound/sword_slash.wav"
            "Link can't reach the flying witches!"
            navi "Use the Mirror Shield!"
            jump twinrova_battle

label twinrova_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    "Twinrova screams and vanishes in an explosion of magic!"
    
    hide twinrova
    
    show link adult at midleft
    show navi at naviright
    
    navi "We did it! All the temples are complete!"

    play music "audio/gerudo_valley_theme.mp3"

    call item_get("Heart Container", "item_heart_container")
    
    "A pillar of orange light appears..."
    
    "A mysterious figure appears in the light..."

    show nabooru at midcenter
    with dissolve
    
    nabooru "Link... thank you for freeing me from the Twinrova's control."
    
    link "Who are you?"
    
    nabooru "I am Nabooru, second in command of the Gerudo thieves. And now... the Sage of Spirit."
    
    play sound "audio/sage_awakening.mp3"
    
    "Nabooru awakens as the Sage of Spirit!"
    
    call item_get("Spirit Medallion", "item_spirit_medallion")
    $ has_spirit_medallion = True
    
    nabooru "All six Sages are now awakened, Link. It's time to face Ganondorf!"
    
    nabooru "Go to the Temple of Time. The other Sages will meet you there."
    
    link "Thank you! I'll end this once and for all!"
    
    scene bg black
    with fade
    
    jump all_sages_gathered

label all_sages_gathered:
    scene bg temple_of_time
    with fade
    
    play music "audio/temple_of_time_theme.mp3" if_changed
    
    show link adult at midleft
    with dissolve
    
    show rauru at midright
    with dissolve
    
    rauru "Link. You have done it. All six Sages have been awakened."
    
    "The other five Sages appear in pillars of light..."
    
    rauru "Together, the Six Sages have the power to seal Ganondorf away. But first, you must defeat him."
    
    "Saria" "Link, we'll lend you our power!"
    
    "Darunia" "Give him a beating for us, Brother!"
    
    "Ruto" "Link, I believe in you!"
    
    "Impa" "The Princess is waiting for you, Link!"
    
    nabooru "Show Ganondorf what true courage looks like!"
    
    rauru "Link, we will create a bridge to Ganondorf's Castle. Use the power of the Six Sages to break his barrier!"
    
    play sound "audio/sage_power.mp3"
    
    "The Six Sages combine their power!"
    
    "A rainbow bridge appears, leading to Ganondorf's Castle!"
    
    rauru "Go, Hero of Time! Fulfill your destiny!"
    
    link "Thank you, everyone. I won't let you down!"
    
    scene bg black
    with fade
    
    jump ganon_castle_approach

label ganon_castle_approach:
    scene bg ganon_castle
    with fade
    
    play music "audio/ganon_castle_theme.mp3" if_changed
    
    show link adult
    show navi at naviright
    
    navi "There it is, Ganondorf's Castle! This is it, Link!"
    
    link "Seven years I've waited for this moment. Let's end this!"
    
    "The Six Sages' power breaks through the barrier!"
    
    play sound "audio/barrier_break.mp3"
    
    "Link enters Ganondorf's Castle..."
    
    scene bg black
    with fade
    
    "Link navigates through six smaller barriers, each representing a Sage..."
    
    "With the power of the Six Sages, Link breaks through all the barriers!"
    
    scene bg ganon_castle
    with fade
    
    show link adult
    show navi at naviright
    
    navi "The path to Ganondorf is open! This is the final battle!"
    
    "Link climbs to the top of the castle tower..."
    
    scene bg throne_room
    with fade
    
    play music "audio/ganondorf_theme.mp3" if_changed
    
    show ganondorf_sprite
    with dissolve
    
    ganondorf "Well, well... The boy who tried to stop me seven years ago. Look at you now."
    
    show link adult at midleft
    
    link "Ganondorf! Your reign of terror ends here!"
    
    ganondorf "Ha ha ha! You think you can defeat me? I hold the Triforce of Power!"
    
    "Ganondorf raises his hand, showing the glowing mark of the Triforce of Power!"
    
    ganondorf "I've waited seven years for this moment as well, boy. I am now the King of Evil!"
    
    show sheik_sprite at midright
    with dissolve
    
    play sound "audio/warp_in.mp3"
    
    sheik "Link! I'm here to help!"
    
    ganondorf "Sheik! Still trying to interfere?"
    
    "Ganondorf fires dark energy at Sheik!"
    
    play sound "audio/dark_magic.mp3"
    
    sheik "Ahh!"
    
    "Sheik falls to the ground!"
    
    link "No!"
    
    "A blinding light surrounds Sheik..."
    
    play music "audio/zelda_theme.mp3" if_changed
    
    hide sheik_sprite
    show zelda adult at midright
    with dissolve
    
    zelda "Link... I'm sorry for deceiving you."
    
    link "Princess Zelda?! You were Sheik all along?!"
    
    zelda "Yes. I disguised myself to escape Ganondorf and guide you on your journey."
    
    ganondorf "How touching. The Princess of Destiny and the Hero of Time, reunited at last!"
    
    ganondorf "But it's too late! With the Triforce of Power, I am invincible!"
    
    zelda "Link, I'll use my power to hold him back! Strike him down!"
    
    link "Right!"
    
    jump final_boss_ganondorf

label final_boss_ganondorf:
    scene bg throne_room
    with fade
    
    play music "audio/ganondorf_battle.mp3" if_changed
    
    show ganondorf_sprite
    show link adult at midleft
    show zelda adult at midright
    
    zelda "I'll create openings for you, Link! Watch for my signals!"
    
    $ ganon_health = 5
    
    jump ganondorf_battle

label ganondorf_battle:
    if ganon_health <= 0:
        jump ganondorf_defeated
    
    show ganondorf_sprite
    
    "Ganondorf floats in the air, hurling dark energy spheres!"
    
    menu:
        zelda "Reflect his magic, Link!"
        
        "Reflect with sword":
            play sound "sound/sword_slash.wav"
            "Link deflects the dark energy ball back at Ganondorf!"
            "Ganondorf deflects it back!"
            "Link deflects it again!"
            play sound "audio/enemy_hit.mp3"
            "The energy hits Ganondorf!"
            show ganondorf_sprite at shake
            
            zelda "Now! While he's stunned!"
            
            menu:
                "Shoot with Light Arrow":
                    play sound "audio/light_arrow.mp3"
                    "Link fires a Light Arrow at Ganondorf!"
                    play sound "audio/enemy_hit.mp3"
                    "Direct hit! Ganondorf falls to the ground!"
                    show ganondorf_sprite at shake
                    
                    menu:
                        zelda "Strike with your sword!"
                        
                        "Attack with Master Sword":
                            play sound "sound/sword_slash.wav"
                            "Link rushes forward and slashes at Ganondorf!"
                            $ ganon_health -= 1
                            play sound "sound/enemy_hit.wav"
                            show ganondorf_sprite at shake
                            
                            if ganon_health > 0:
                                play sound "audio/enemy_hurt.mp3"
                                ganondorf "Grrr! You pest!"
                                "Ganondorf floats back up!"
                                zelda "Keep going! [ganon_health] more times!"
                                jump ganondorf_battle
                            else:
                                jump ganondorf_defeated
                                
                        "Wait":
                            "Ganondorf recovers and floats back up!"
                            zelda "You have to be faster!"
                            jump ganondorf_battle
                            
                "Use regular arrows":
                    play sound "audio/bow_shot.mp3"
                    "The arrow bounces off Ganondorf!"
                    zelda "Use the Light Arrows I gave you!"
                    jump ganondorf_battle
                    
        "Attack directly":
            play sound "sound/sword_slash.wav"
            "Link can't reach the floating Ganondorf!"
            zelda "Reflect his magic first!"
            jump ganondorf_battle

label ganondorf_defeated:
    play sound "audio/enemy_defeat.mp3"
    
    ganondorf "Impossible! I have the Triforce of Power! I cannot be defeated!"
    
    "Ganondorf falls to his knees!"
    
    hide ganondorf_sprite
    
    show link adult at midleft
    show zelda adult at midright
    
    zelda "We did it, Link! Ganondorf is defeated!"
    
    link "Is it... is it really over?"
    
    zelda "The Six Sages will seal him away now. Hyrule is saved!"
    
    play sound "audio/sage_power.mp3"
    
    "The power of the Six Sages begins to seal Ganondorf..."
    
    show ganondorf_sprite
    with dissolve
    
    ganondorf "You... you think this is over?!"
    
    "Ganondorf's hand glows with the Triforce of Power!"
    
    ganondorf "If I am to be sealed away... then I will drag you all down with me!"
    
    play sound "audio/explosion.mp3"
    
    "Ganondorf causes the castle to collapse!"
    
    zelda "The castle is falling! Link, we have to escape!"
    
    scene bg black
    with fade
    
    jump castle_escape

label castle_escape:
    play music "audio/escape_theme.mp3" if_changed
    
    scene bg ganon_castle
    with fade
    
    show link adult
    show zelda adult at midright
    
    zelda "Run, Link! This way!"
    
    "Link and Zelda race through the collapsing castle!"
    
    "Debris falls around them as they navigate the crumbling corridors!"
    
    navi "Keep going! We're almost out!"
    
    "Link and Zelda burst through the castle entrance just as it collapses behind them!"
    
    with fade
    
    show link adult at midleft
    show zelda adult at midright
    
    link "We made it..."
    
    zelda "It's finally over, Link. Ganondorf is sealed beneath the rubble."
    
    "The ground begins to shake!"
    
    play sound "audio/rumble.mp3"
    
    navi "What's happening?!"
    
    "The rubble of the castle explodes!"
    
    play sound "audio/massive_explosion.mp3"
    
    scene bg black
    with fade
    
    play music "audio/ganondorf_theme.mp3" if_changed
    
    ganondorf "YOU... HAVE NOT... WON!"
    
    scene bg final_battle
    with fade
    
    show ganon
    with dissolve
    
    "A massive beast emerges from the ruins, Ganon, the Demon King!"
    
    show link adult at midleft
    show zelda adult at midright
    
    zelda "He's transformed into Ganon! His true form!"
    
    "Ganon swings his massive sword and knocks the Master Sword from Link's hand!"
    
    play sound "audio/sword_drop.mp3"
    
    "The Master Sword flies out of reach!"
    
    link "No! My sword!"
    
    zelda "Link! I'll try to hold him back! Find a way to defeat him!"
    
    "Zelda uses her magic to keep Ganon at bay!"
    
    jump final_boss_ganon

label final_boss_ganon:
    scene bg final_battle
    with fade
    
    play music "audio/ganondorf_battle.mp3" if_changed
    
    show ganon
    show link adult at midleft
    
    navi "Link! You have to fight without the Master Sword!"
    
    "Ganon swings his massive twin swords!"
    
    $ ganon_health = 5
    
    jump ganon_battle

label ganon_battle:
    if ganon_health <= 0:
        jump ganon_final_defeated
    
    show ganon
    
    "Ganon charges at Link with his enormous blades!"
    
    menu:
        navi "What will you do?"
        
        "Roll behind Ganon":
            play sound "audio/roll.mp3"
            "Link rolls behind Ganon!"
            
            menu:
                navi "Attack his tail! It's his weak point!"
                
                "Strike tail with hammer":
                    play sound "audio/hammer_smash.mp3"
                    "Link smashes Ganon's tail with the Megaton Hammer!"
                    play sound "audio/enemy_hit.mp3"
                    "Ganon roars in pain!"
                    $ ganon_health -= 1
                    play sound "sound/enemy_hit.wav"
                    show ganon at shake
                    
                    if ganon_health == 2:
                        zelda "Link! The Master Sword! I'll make an opening!"
                        "Zelda's light creates a path to the Master Sword!"
                        play sound "audio/sword_pickup.mp3"
                        "Link retrieves the Master Sword!"
                        zelda "Finish him, Link!"
                    
                    if ganon_health > 0:
                        "Ganon recovers and turns around!"
                        navi "Keep attacking! [ganon_health] more times!"
                        jump ganon_battle
                    else:
                        jump ganon_final_defeated
                        
                "Use light arrows":
                    play sound "audio/light_arrow.mp3"
                    "Link shoots a Light Arrow at Ganon's face!"
                    play sound "audio/enemy_hit.mp3"
                    "Ganon is stunned!"
                    $ ganon_health -= 1
                    play sound "sound/enemy_hit.wav"
                    show ganon at shake
                    
                    if ganon_health > 0:
                        navi "[ganon_health] more!"
                        jump ganon_battle
                    else:
                        jump ganon_final_defeated
                        
        "Block with shield":
            play sound "audio/shield_block.mp3"
            "Link blocks Ganon's attack, but is pushed back!"
            navi "You need to attack, not just defend!"
            jump ganon_battle
            
        "Attack head-on":
            play sound "sound/sword_slash.wav"
            "Ganon's armor deflects the attack!"
            navi "Get behind him!"
            jump ganon_battle

label ganon_final_defeated:
    scene bg final_battle
    play sound "audio/enemy_defeat.mp3"
    play music "audio/ganondorf_battle.mp3" if_changed
    
    "Ganon falls to his knees, weakened!"
    
    show link adult at midleft
    show zelda adult at midright
    
    zelda "Now, Link! Deliver the final blow!"
    
    menu:
        zelda "Strike him down with the Master Sword!"
        
        "Finish Ganon":
            hide link adult with dissolve
            hide zelda adult with dissolve
            show bg black
            with dissolve
            pause 1
            $ renpy.movie_cutscene("videos/oot_ganon_defeated.webm")

            scene bg final_battle
            play music "audio/ganondorf_battle.mp3" if_changed
            
            "Ganon lets out a final roar!"

            show ganon at midleft
            with dissolve
            show zelda adult at midright
            with dissolve
            
            ganondorf "You... you have only delayed my return... I will... rise again..."
            
            zelda "6 Sages! Now!"
            
            play sound "audio/sage_power.mp3"
            
            "The Six Sages appear and channel their power!"
            
            "A portal opens in the sky!"
            
            zelda "Ganon, the Evil King... In the name of the Six Sages, I command you to be sealed away!"
            
            hide ganon with dissolve
            hide zelda adult with dissolve
            show bg black
            with dissolve
            pause 1
            $ renpy.movie_cutscene("videos/oot_zelda_call.webm")
            $ renpy.movie_cutscene("videos/oot_ganon_sealed.webm")
            stop music

            scene bg black

            "Ganon is pulled into the portal and sealed in the Sacred Realm!"
            
            scene bg black
            with fade
            
            jump ending


label ending:
    scene bg hyrule_field
    with fade
    
    play music "audio/zelda_theme.mp3" if_changed
    
    show link adult at midleft
    show zelda adult at midright
    
    "The darkness lifts from Hyrule. The sun shines brightly once more."
    
    zelda "Link... thank you. You saved Hyrule."
    
    link "We did it together, Princess. You, me, and the Sages."
    
    zelda "Link, there's something I must do. You've sacrificed seven years of your childhood to save Hyrule."
    
    zelda "With the power of the Ocarina of Time, I can send you back to your own time. Back to when you were a child."
    
    link "Send me back? But... what about everything that happened?"
    
    zelda "If you return to the past, you can reclaim those lost years. You can have the childhood you deserved."
    
    zelda "But you must take the Ocarina of Time and close the Door of Time before Ganondorf can enter the Sacred Realm."
    
    menu:
        zelda "What do you wish to do?"
        
        "Return to the past":
            link "I want to go back. I want to warn everyone before Ganondorf gains power."
            zelda "Then it shall be done."
            
        "Stay in this time":
            link "But if I go back, will I remember any of this? Will I remember you?"
            zelda "Our paths will cross again, Link. I know they will. Trust in our destiny."
            link "...Alright. Send me back."
    
    zelda "Link... in the past, close the Door of Time with the Ocarina. Ganondorf will never reach the Sacred Realm."
    
    zelda "And Link... even if you forget, I will never forget what you did for Hyrule. You will always be our Hero of Time."
    
    link "Princess... Zelda..."
    
    play sound "audio/time_warp.mp3"
    
    scene bg white
    with fade
    
    "Zelda plays the Ocarina of Time..."
    
    "Link is transported back through time..."
    
    scene bg temple_of_time
    with fade
    
    show link child
    with dissolve
    
    link "I'm... I'm a child again."
    
    show navi at naviright
    
    navi "Link, we're back in the past! Before you drew the Master Sword!"
    
    link "We have to close the Door of Time and stop Ganondorf!"
    
    "Link plays the Ocarina of Time..."
    
    play sound "audio/door_close.mp3"
    
    "The Door of Time closes, sealing the Sacred Realm!"
    
    "Without access to the Sacred Realm, Ganondorf's plan is thwarted!"
    
    scene bg castle_courtyard
    with fade
    
    show link child at midleft
    show zelda child at midright
    
    "Link rushes to see Princess Zelda..."
    
    zelda "Link? What's wrong? You look like you've seen something terrible."
    
    link "Princess, I know this sounds strange, but you have to trust me. Ganondorf is planning to betray your father and steal the Triforce!"
    
    zelda "How... how do you know this?"
    
    link "I can't explain. But please, warn your father. Don't let Ganondorf near the Sacred Realm!"
    
    zelda "I... I believe you, Link. I've had the same fears in my dreams."
    
    zelda "I'll tell my father everything. Thank you, Link."
    
    link "Take this. Keep it safe."
    
    "Link hands Zelda the Ocarina of Time..."
    
    zelda "The Ocarina of Time... Link, I don't understand, but I trust you."
    
    zelda "Will I see you again?"
    
    link "I hope so, Princess. Take care of yourself."
    
    scene bg kokiri_forest
    with fade
    
    play music "audio/kokiri_forest_theme.mp3" if_changed
    
    show link child at midleft
    with dissolve
    show navi at naviright
    
    navi "Link, what will you do now?"
    
    link "I don't know, Navi. I feel like I've lived a lifetime, but I'm still just a kid."
    
    show saria_sprite at midcenter
    with dissolve
    
    saria "Link! There you are! I've been looking for you!"
    
    link "Saria!"
    
    saria "Are you okay? You seem different somehow..."
    
    link "I'm fine, Saria. Better than fine. I'm home."
    
    saria "Come on! Let's go play in the meadow like old times!"
    
    link "Yeah... let's do that."
    
    "Link looks up at the sky, where he knows, in another time, another world, he stood as a hero."
    
    "But here, now, he is just a boy in the forest."
    
    "And for the moment, that's enough."

    jump ending_final

label ending_final:
    
    scene bg black
    with fade
    
    play music "audio/credits_theme.mp3" if_changed

    "Link's journey through time saved Hyrule from darkness."
    
    "The Six Sages returned to protect the Sacred Realm."
    
    "Princess Zelda ruled wisely, keeping peace in the land."
    
    "And Link, the Hero of Time, lived on in legend..."
    
    "His story passed down through generations..."
    
    "A tale of courage, wisdom, and power..."
    
    show expression VBox(
        Text("The End", size=60, xalign=0.5),
        spacing=20
    ) as the_end at truecenter with dissolve
    pause 3

    show expression VBox(
        Text("Original Game Developed by Nintendo (1998)", size=60, xalign=0.5),
        spacing=20
    ) as the_end at truecenter with dissolve
    pause 3

    show expression VBox(
        Text("Thanks for Playing!", size=60, xalign=0.5),
        spacing=20
    ) as the_end at truecenter with dissolve
    pause 3
    
    hide the_end
    with dissolve
    
    return